// ğŸ“‹ RIDER DASHBOARD - API ENDPOINTS DOCUMENTATION
// This document describes all API endpoints needed for the enhanced rider dashboard

/*
âœ… FEATURES IMPLEMENTED IN FRONTEND:
1. Available orders to accept/reject
2. Active deliveries monitoring
3. Delivery history/records tracking
4. Google Maps integration (external launch - no API calls)
5. Call customer feature
6. Order status progression
7. Auto-refresh of available orders
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 1. GET AVAILABLE ORDERS (Orders pending assignment to any rider)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: GET /api/rider/available-orders
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Fetch pending orders that haven't been assigned to any rider yet.
            These are orders the rider can choose to accept.

RESPONSE:
{
  "success": true,
  "orders": [
    {
      "id": "123",
      "order_number": "ORD-001",
      "customer_id": "cust_001",
      "customer_name": "John Doe",
      "customer_phone": "+250712345678",
      "vendor_id": "vendor_001",
      "vendor_name": "KFC Restaurant",
      "status": "pending",
      "subtotal": 25000,
      "delivery_fee": 2000,
      "total": 27000,
      "created_at": "2025-01-27T10:30:00Z",
      "items": [
        {
          "id": "item_001",
          "product_id": "prod_001",
          "product_name": "Fried Chicken",
          "quantity": 2,
          "price": 10000,
          "total": 20000
        }
      ],
      "delivery_info": {
        "address": "123 Main Street, Kigali",
        "latitude": -1.9441,
        "longitude": 30.0619
      },
      "special_instructions": "Ring the doorbell twice",
      "payment_method": "cash",
      "latitude": -1.9536,      // Vendor location
      "longitude": 30.0586       // Vendor location
    }
  ],
  "count": 1
}
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 2. ACCEPT AN ORDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: POST /api/rider/orders/{orderId}/accept
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Accept an available order. Sets rider_id and changes status to 'confirmed'

REQUEST BODY: (empty or {})

RESPONSE:
{
  "success": true,
  "message": "Order accepted successfully",
  "order": {
    "id": "123",
    "status": "confirmed",
    "accepted_at": "2025-01-27T10:35:00Z",
    "rider_id": "rider_001"
  }
}

ERROR CASES:
- 404: Order not found or already assigned
- 400: Invalid order status for acceptance
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 3. REJECT AN ORDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: POST /api/rider/orders/{orderId}/reject
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Reject an available order without accepting it. Order remains pending.

REQUEST BODY: (empty or {})

RESPONSE:
{
  "success": true,
  "message": "Order rejected",
  "order_id": "123"
}

NOTES:
- Order stays available for other riders to accept
- Rider cannot accept the same order again (optional - implement time-based cooldown)
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 4. GET ASSIGNED/ACTIVE ORDERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: GET /api/rider/orders
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Get all orders assigned to the current rider that are in progress
            (confirmed, preparing, ready, picked_up statuses)

RESPONSE:
{
  "success": true,
  "orders": [
    {
      "id": "123",
      "order_number": "ORD-001",
      "customer_id": "cust_001",
      "customer_name": "John Doe",
      "customer_phone": "+250712345678",
      "vendor_id": "vendor_001",
      "vendor_name": "KFC Restaurant",
      "status": "confirmed",
      "subtotal": 25000,
      "delivery_fee": 2000,
      "total": 27000,
      "created_at": "2025-01-27T10:30:00Z",
      "accepted_at": "2025-01-27T10:35:00Z",
      "items": [...],
      "delivery_info": {
        "address": "123 Main Street, Kigali",
        "latitude": -1.9441,
        "longitude": 30.0619
      },
      "payment_method": "cash",
      "latitude": -1.9536,      // Vendor location
      "longitude": 30.0586       // Vendor location
    }
  ],
  "count": 1
}
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 5. GET DELIVERY HISTORY (Completed orders)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: GET /api/rider/orders/history
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Get all completed deliveries for the current rider
            Can be filtered by date range

QUERY PARAMETERS (optional):
- start_date: ISO date (2025-01-01)
- end_date: ISO date (2025-01-31)
- limit: Number of records (default 50)
- offset: Pagination offset (default 0)

RESPONSE:
{
  "success": true,
  "orders": [
    {
      "id": "123",
      "order_number": "ORD-001",
      "customer_id": "cust_001",
      "customer_name": "John Doe",
      "vendor_id": "vendor_001",
      "vendor_name": "KFC Restaurant",
      "status": "completed",
      "total": 27000,
      "created_at": "2025-01-27T10:30:00Z",
      "accepted_at": "2025-01-27T10:35:00Z",
      "completed_at": "2025-01-27T11:15:00Z",
      "items": [...]
    }
  ],
  "count": 15,
  "total": 45
}
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 6. UPDATE ORDER STATUS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
ENDPOINT: PUT /api/rider/orders/{orderId}/status
AUTHENTICATION: Required (Bearer token)
DESCRIPTION: Update order status to next step

REQUEST BODY:
{
  "status": "preparing"  // or "ready", "picked_up", "completed"
}

RESPONSE:
{
  "success": true,
  "message": "Order status updated",
  "order": {
    "id": "123",
    "status": "preparing",
    "updated_at": "2025-01-27T10:40:00Z"
  }
}

STATUS PROGRESSION:
pending â†’ confirmed â†’ preparing â†’ ready â†’ picked_up â†’ completed

NOTES:
- Rider can only set status to the next valid step
- Use timestamps: preparing_at, ready_at, picked_up_at when status changes
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FRONTEND IMPLEMENTATION SUMMARY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
ğŸ¯ RIDER DASHBOARD FEATURES IMPLEMENTED:

1. âœ… AVAILABLE ORDERS TAB (Pending orders)
   - Shows 0 orders when offline
   - Real-time list of available orders
   - Accept/Reject buttons
   - Auto-refresh every 15 seconds
   - Pull-to-refresh
   
2. âœ… ACTIVE DELIVERIES TAB (Assigned orders)
   - Shows all orders being delivered
   - Order cards with customer info, vendor info
   - Quick action buttons:
     * View Details (shows full order + location buttons)
     * Navigate (opens vendor location in Google Maps)
     * Call Customer
   - Status progression buttons in detail view
   
3. âœ… DELIVERY HISTORY TAB (Completed orders)
   - Shows all completed deliveries
   - Sorted by most recent
   - Displays:
     * Order number & date
     * Customer name
     * Vendor name
     * Total amount
     * Number of items
     * Delivery time (minutes from acceptance to completion)
   - Pull-to-refresh

4. âœ… GOOGLE MAPS INTEGRATION (EXTERNAL - NO API CALLS)
   - Open customer location in Google Maps
   - Open vendor location in Google Maps
   - Both use url_launcher to open external app
   - Reduces API calls significantly
   
5. âœ… ADDITIONAL FEATURES
   - Call customer (phone integration)
   - Online/Offline toggle
   - Real-time order monitoring
   - Order status tracking
   - Special instructions display

ğŸ”‘ KEY IMPLEMENTATION DETAILS:

â€¢ All customer & vendor locations use EXTERNAL Google Maps (url_launcher)
  â†’ Opens in Google Maps app or web browser
  â†’ No API calls made from app for map viewing
  
â€¢ Auto-refresh set to 15 seconds for available orders
  
â€¢ Pull-to-refresh available on all three tabs
  
â€¢ Order status progression:
  pending â†’ confirmed â†’ preparing â†’ ready â†’ picked_up â†’ completed
  
â€¢ All data persists correctly in the Order model with location fields added

*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BACKEND INTEGRATION CHECKLIST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
REQUIREMENTS TO IMPLEMENT BACKEND:

â˜ 1. GET /api/rider/available-orders
   - Return orders with status = 'pending'
   - No rider_id assigned yet
   - Include vendor latitude/longitude
   - Include delivery address & coordinates
   - Sort by created_at DESC (newest first)

â˜ 2. POST /api/rider/orders/{orderId}/accept
   - Set order.rider_id = current_user.id
   - Set order.status = 'confirmed'
   - Set order.accepted_at = now
   - Send notification to vendor
   - Return updated order

â˜ 3. POST /api/rider/orders/{orderId}/reject
   - Record rejection (optional - for analytics)
   - Keep order.status = 'pending'
   - Order available for other riders
   - Return success

â˜ 4. GET /api/rider/orders (existing, but verify)
   - Return orders where rider_id = current_user.id
   - Status IN ('confirmed', 'preparing', 'ready', 'picked_up')
   - Include all necessary fields including vendor location

â˜ 5. GET /api/rider/orders/history (new endpoint)
   - Return orders where rider_id = current_user.id
   - Status = 'completed'
   - Support pagination
   - Support date range filtering

â˜ 6. PUT /api/rider/orders/{orderId}/status (update existing)
   - Validate status progression
   - Update appropriate timestamp fields:
     * preparing_at when status = 'preparing'
     * ready_at when status = 'ready'
     * picked_up_at when status = 'picked_up'
     * completed_at when status = 'completed'

*/
